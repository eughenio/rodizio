<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&language=br"></script>
  <title>Rodizio São Paulo - SP</title>
</head>
<body>
  <div class="container-fluid">

    <div class="row">
      <div id="map_canvas" class=".col-lg-12"></div>
    </div>

    <div id="footer">
      <p>
        Made with &#9829; in São Paulo
      </p>
    </div>

  </div>

  <script>
    $(function(){
      $('#map_canvas').css('width',$('.container').width());
      $('#map_canvas').css('height',$(window).height()-50);

      var markers = [];

      var mapCanvas = document.getElementById('map_canvas');
      var mapOptions = {
        zoom: 12,
        panControl: false,
        scaleControl: true,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      }

      var map = new google.maps.Map(mapCanvas, mapOptions);

      var ctaLayer = new google.maps.KmlLayer({
        url: 'rodizio.kmz'
      });
      ctaLayer.setMap(map);

      // Try HTML5 geolocation
      if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var pos = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);

          var marker = {
            map:map,
            position: pos,
            content: 'Você está aqui!'
          };

          var infowindow = new google.maps.InfoWindow(marker);
          map.setCenter(marker.position);

        }, function() {
          handleNoGeolocation(true);
        });
      } else {
        // Browser doesn't support Geolocation
        handleNoGeolocation(false);
      }

      function handleNoGeolocation(errorFlag) {
        if (errorFlag) {
          var content = 'Error: The Geolocation service failed.';
        } else {
          var content = 'Error: Your browser doesn\'t support geolocation.';
        }

        var options = {
          map: map,
          position: new google.maps.LatLng(23.5500, 46.6333),
          content: content
        };

        var infowindow = new google.maps.InfoWindow(options);
        map.setCenter(options.position);
      }

    });
  </script>
</body>
</html>
